(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))C(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&C(h)}).observe(document,{childList:!0,subtree:!0});function d(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function C(r){if(r.ep)return;r.ep=!0;const a=d(r);fetch(r.href,a)}})();function O(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function i(n){const e=document.createElement("div");return n&&(e.className=n),e}function P(n,e){const d=document.createElement("button");return d.type="button",d.className=e?`btn ${e}`:"btn",d.textContent=n,d}function R(n){const e=document.createElement("input");return e.type="text",e.className="input",e.placeholder=n,e.autocomplete="off",e.spellcheck=!1,e}function U(n){const e=document.createElement("div");return e.className="h1",e.textContent=n,e}function k(n){const e=document.createElement("div");return e.className="p",e.textContent=n,e}async function q(){const n=document.querySelector("#app"),e=await window.go.main.App.GetStatus();if(e.started==="true"&&e.viewerURL){window.location.href=e.viewerURL;return}return F(n)}async function F(n){O(n);const e=i("shell"),d=i("top");d.appendChild(U("Goop")),d.appendChild(k("Pick a peer, or create a new one.")),e.appendChild(d);const C=i("grid"),r=i("card"),a=i("cardHead");a.appendChild(k("Peers")),r.appendChild(a);const h=i("cardBody"),x=i("tileList");h.appendChild(x),r.appendChild(h);const g=i("cardFoot"),p=P("Start","primary");p.disabled=!0;const u=P("Delete","danger");u.disabled=!0;const c=i("status"),l=i("error");g.appendChild(p),g.appendChild(u),g.appendChild(c),g.appendChild(l),r.appendChild(g);const b=i("card"),A=i("cardHead");A.appendChild(k("Create new peer")),b.appendChild(A);const N=i("cardBody"),v=i("row"),L=R("peerC"),m=P("Create","secondary");v.appendChild(L),v.appendChild(m),N.appendChild(v),b.appendChild(N),C.appendChild(r),C.appendChild(b),e.appendChild(C),n.appendChild(e);let w=await window.go.main.App.ListPeers(),o="";function y(t){o=t,p.disabled=!o,u.disabled=!o,l.textContent="",c.textContent=o?`Selected: ${o}`:""}function $(){if(O(x),!w||w.length===0){const t=i("empty");t.textContent="No peers found.",x.appendChild(t),y("");return}for(const t of w){const s=i("tile"),E=i("tileLeft"),f=document.createElement("input");f.type="radio",f.name="peer",f.checked=t===o,f.addEventListener("change",()=>y(t));const S=i("tileMeta"),B=i("tileName");B.textContent=t;const H=i("tilePath");H.textContent=`./peers/${t}/goop.json`,S.appendChild(B),S.appendChild(H),E.appendChild(f),E.appendChild(S),s.addEventListener("click",G=>{G.target!==f&&(f.checked=!0,y(t))}),s.appendChild(E),x.appendChild(s)}}async function D(t){w=await window.go.main.App.ListPeers(),t&&w.includes(t)?y(t):w.includes(o)||y(""),$()}p.addEventListener("click",async()=>{if(!!o){p.disabled=!0,u.disabled=!0,l.textContent="",c.textContent="Starting\u2026";try{await window.go.main.App.StartPeer(o);const t=await window.go.main.App.GetStatus();window.location.href=t.viewerURL}catch(t){l.textContent=String(t),c.textContent="",p.disabled=!1,u.disabled=!1}}}),u.addEventListener("click",async()=>{if(!(!o||!window.confirm(`Delete peer "${o}"?

This will remove ./peers/${o}/`))){l.textContent="",c.textContent="Deleting\u2026",p.disabled=!0,u.disabled=!0;try{await window.go.main.App.DeletePeer(o),await D(""),c.textContent="Deleted."}catch(s){l.textContent=String(s),c.textContent=""}finally{p.disabled=!o,u.disabled=!o}}}),m.addEventListener("click",async()=>{l.textContent="",c.textContent="";const t=L.value.trim();if(!t){l.textContent="Enter a peer name.";return}m.disabled=!0,m.textContent="Creating\u2026";try{const s=await window.go.main.App.CreatePeer(t);L.value="",await D(s),c.textContent=`Created: ${s}`}catch(s){l.textContent=String(s)}finally{m.disabled=!1,m.textContent="Create"}}),$(),y("")}q();
