(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))h(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&h(c)}).observe(document,{childList:!0,subtree:!0});function o(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function h(a){if(a.ep)return;a.ep=!0;const i=o(a);fetch(a.href,i)}})();const F="/assets/goop2-splash.8bd7ac35.png";function I(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function M(e,t){const o=document.createElement(e);return t&&(o.className=t),o}function r(e){return M("div",e)}function P(e,t){const o=document.createElement("button");return o.type="button",o.className=t?`btn ${t}`:"btn",o.textContent=e,o}function j(e){const t=document.createElement("input");return t.type="text",t.className="input",t.placeholder=e,t.autocomplete="off",t.spellcheck=!1,t}function q(e){const t=r("h1");return t.textContent=e,t}function T(e){const t=r("p");return t.textContent=e,t}function x(e){return e==="light"||e==="dark"?e:"dark"}function H(e){try{e=x(e),document.documentElement.setAttribute("data-theme",e),localStorage.setItem("goop.theme",e)}catch{}}function K(e){return String(e||"").replace(/\/+$/,"")}async function V(){try{const e=await window.go.main.App.GetTheme();return x(e)}catch{return"dark"}}async function W(e){e=x(e),H(e);try{await window.go.main.App.SetTheme(e)}catch{}}async function J(){const e=document.getElementById("themeToggle");if(!e)return;const t=await V();H(t),e.checked=t==="light",e.addEventListener("change",async()=>{const o=e.checked?"light":"dark";await W(o)})}async function O(e,t){const o=K(e);if(!o)throw new Error("viewerURL is empty");const h=t&&String(t).startsWith("/")?t:"/peers",a=x(document.documentElement.getAttribute("data-theme"));let i="";try{i=await window.go.main.App.GetBridgeURL()}catch{i=""}const c=new URL(o+h);c.searchParams.set("theme",a),i&&c.searchParams.set("bridge",i),window.location.replace(c.toString())}async function Q(e){I(e),e.classList.add("launcher-host");const t=r("launcher"),o=r("launcher-splash"),h=document.createElement("img");h.src=F,h.alt="Goop\xB2",o.appendChild(h),t.appendChild(o);const a=r("launcher-panel"),i=r("top");i.appendChild(q("Goop\xB2 - Launcher")),i.appendChild(T("Pick a peer, or create a new one.")),a.appendChild(i);const c=r("card"),B=r("cardHead");B.appendChild(T("Create new peer")),c.appendChild(B);const U=r("cardBody"),v=r("row"),E=j("peerC"),g=P("Create","secondary");v.appendChild(E),v.appendChild(g),U.appendChild(v),c.appendChild(U),a.appendChild(c);const b=r("card peersCard"),R=r("cardHead");R.appendChild(T("Peers")),b.appendChild(R);const $=r("cardBody"),L=r("tileList");$.appendChild(L),b.appendChild($);const y=r("cardFoot"),m=P("Start","primary");m.disabled=!0;const f=P("Delete","danger");f.disabled=!0;const l=r("status"),p=r("error");y.appendChild(m),y.appendChild(f),y.appendChild(l),y.appendChild(p),b.appendChild(y),a.appendChild(b),t.appendChild(a),e.appendChild(t);let u=await window.go.main.App.ListPeers(),d="";function C(n){d=n,m.disabled=!d,f.disabled=!d,p.textContent="",l.textContent=d?`Selected: ${d}`:""}function S(){if(I(L),!u||u.length===0){const n=r("empty");n.textContent="No peers found.",L.appendChild(n),C("");return}for(const n of u){const s=r("tile"),k=r("tileLeft"),w=document.createElement("input");w.type="radio",w.name="peer",w.checked=n===d,w.addEventListener("change",()=>C(n));const A=r("tileMeta"),N=r("tileName");N.textContent=n;const D=r("tilePath");D.textContent=`./peers/${n}/goop.json`,A.appendChild(N),A.appendChild(D),k.appendChild(w),k.appendChild(A),s.addEventListener("click",z=>{z.target!==w&&(w.checked=!0,C(n))}),s.appendChild(k),L.appendChild(s)}}async function G(n){u=await window.go.main.App.ListPeers(),n&&u.includes(n)?C(n):u.includes(d)||C(""),S()}m.addEventListener("click",async()=>{if(!!d){m.disabled=!0,f.disabled=!0,p.textContent="",l.textContent="Starting\u2026";try{await window.go.main.App.StartPeer(d);const n=await window.go.main.App.GetStatus();if(!n||!n.viewerURL)throw new Error("Started but viewerURL missing from status.");await O(n.viewerURL,"/peers")}catch(n){p.textContent=String(n),l.textContent="",m.disabled=!1,f.disabled=!1}}}),f.addEventListener("click",async()=>{if(!(!d||!window.confirm(`Delete peer "${d}"?

This will remove ./peers/${d}/`))){p.textContent="",l.textContent="Deleting\u2026",m.disabled=!0,f.disabled=!0;try{await window.go.main.App.DeletePeer(d),await G(""),l.textContent="Deleted."}catch(s){p.textContent=String(s),l.textContent=""}finally{m.disabled=!d,f.disabled=!d}}}),g.addEventListener("click",async()=>{p.textContent="",l.textContent="";const n=E.value.trim();if(!n){p.textContent="Enter a peer name.";return}g.disabled=!0,g.textContent="Creating\u2026";try{const s=await window.go.main.App.CreatePeer(n);E.value="",await G(s),l.textContent=`Created: ${s}`}catch(s){p.textContent=String(s)}finally{g.disabled=!1,g.textContent="Create"}}),S(),C(""),u&&u.length>0&&(C(u[0]),S())}async function X(){await J();const e=await window.go.main.App.GetStatus();if(e&&e.started==="true"&&e.viewerURL){await O(e.viewerURL,"/peers");return}const t=document.getElementById("content")||document.getElementById("app");!t||await Q(t)}X();
