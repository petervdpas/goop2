{{define "page.templates"}}
<div class="page page-templates" data-csrf="{{.CSRF}}">
  <div class="create-tabs">
    <a class="create-tab" href="/edit">Editor</a>
    <a class="create-tab active" href="/templates">Templates</a>
    <a class="create-tab" href="/lua">Lua Scripts</a>
    <a class="create-tab" href="/create/groups">Groups</a>
  </div>

  <h2 class="tpl-heading">Choose a template</h2>
  <p class="muted small tpl-sub">Applying a template will replace your entire site and database.</p>

  <h3 class="tpl-section-heading">Built-in</h3>
  <div class="tpl-grid">
    {{range .Templates}}
    <div class="tpl-card{{if eq .Dir $.ActiveTemplate}} tpl-card-active{{end}}" data-dir="{{.Dir}}" data-source="builtin">
      {{if eq .Dir $.ActiveTemplate}}<span class="tpl-active-star" title="Currently active">&#9733;</span>{{end}}
      <div class="tpl-card-icon">{{.Icon}}</div>
      <div class="tpl-card-body">
        <div class="tpl-card-name">{{.Name}}</div>
        <div class="tpl-card-cat muted small">{{.Category}}</div>
        <div class="tpl-card-desc small">{{.Description}}</div>
      </div>
      <button type="button" class="tpl-card-apply" data-dir="{{.Dir}}" data-name="{{.Name}}" data-source="builtin">
        Apply
      </button>
    </div>
    {{else}}
    <div class="muted">No built-in templates available.</div>
    {{end}}
  </div>

  <h3 class="tpl-section-heading">Template Store <span class="tpl-badge-store">store</span></h3>
  {{if .StoreError}}
  <div class="muted small">{{.StoreError}}</div>
  {{else if .StoreTemplates}}
  <div class="tpl-grid">
    {{$prices := .StoreTemplatePrices}}
    {{range .StoreTemplates}}
    {{$owned := $.OwnedTemplates}}
    <div class="tpl-card{{if eq .Dir $.ActiveTemplate}} tpl-card-active{{end}}" data-dir="{{.Dir}}" data-source="store">
      {{if eq .Dir $.ActiveTemplate}}<span class="tpl-active-star" title="Currently active">&#9733;</span>{{else if and $owned (index $owned .Dir)}}<span class="tpl-owned-star" title="Previously applied">&#9733;</span>{{end}}
      <div class="tpl-card-head">
        <div class="tpl-card-icon">{{.Icon}}</div>
        {{if $.HasCredits}}{{if and $prices (gt (index $prices .Dir) 0)}}<span class="tpl-price tpl-price-credits">ðŸª™ {{index $prices .Dir}}</span>{{else}}<span class="tpl-price tpl-price-free">Free</span>{{end}}{{end}}
      </div>
      <div class="tpl-card-body">
        <div class="tpl-card-name">{{.Name}} <span class="tpl-badge-store">store</span></div>
        <div class="tpl-card-cat muted small">{{.Category}}</div>
        <div class="tpl-card-desc small">{{.Description}}</div>
      </div>
      <button type="button" class="tpl-card-apply" data-dir="{{.Dir}}" data-name="{{.Name}}" data-source="store">
        Apply
      </button>
    </div>
    {{end}}
  </div>
  {{else}}
  <div class="muted small">No store templates available.</div>
  {{end}}

</div>
{{end}}
