<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{.Title}}</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="/assets/style.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="header-left">
        <div class="logo">ğŸ§©</div>
        <div>
          <h1>GoopÂ² Template Store</h1>
          <p class="subtitle">Ready-made sites for your GoopÂ² peer</p>
        </div>
      </div>
      <div class="header-right">
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
          <span class="theme-icon">ğŸŒ™</span>
        </button>
        <a class="nav-link" href="/">GoopÂ²</a>
        {{if .HasCredits}}<a class="nav-link" href="/credits">ğŸª™ Credits</a>{{end}}
        <a class="nav-link" href="/docs">Docs</a>
        {{if .HasAdmin}}<a class="nav-link" href="/admin">Admin</a>{{end}}
      </div>
    </header>

    <!-- Credit banner slot (injected by CreditProvider) -->
    {{.CreditData.Banner}}

    {{if .RegistrationRequired}}
    <div class="store-banner" style="background:var(--purple-dim,rgba(128,90,213,0.08));border:1px solid var(--border);color:var(--text-secondary,var(--muted));padding:0.75rem 1rem;border-radius:8px;margin-bottom:1rem">
      <a href="/register">Register your email</a> to unlock template purchases{{if .RegistrationCredits}} and receive <strong>{{.RegistrationCredits}} free credits</strong>{{end}}.
    </div>
    {{end}}

    {{if .Templates}}
    <div class="store-grid">
      {{range .Templates}}
      <div class="store-card glass">
        <div class="store-card-head">
          <div class="store-card-icon">{{.Meta.Icon}}</div>
          <div class="store-card-price">{{if .IsActive}}<span class="tpl-price-active">&#9733;</span>{{else}}{{.PriceLabel}}{{end}}</div>
        </div>
        <div class="store-card-body">
          <div class="store-card-name">{{.Meta.Name}}</div>
          <div class="store-card-cat">{{.Meta.Category}}</div>
          <div class="store-card-desc">{{.Meta.Description}}</div>
        </div>
        <div class="store-card-footer">
          <span class="store-card-dir">{{.Meta.Dir}}</span>
          <a class="store-card-dl" href="/api/templates/{{.Meta.Dir}}/bundle" title="Download bundle">â¬‡ Download</a>
        </div>
      </div>
      {{end}}
    </div>
    {{else}}
    <div class="empty-state">
      <div class="empty-icon">ğŸ“¦</div>
      <p>No templates available on this server yet.</p>
    </div>
    {{end}}

    {{if .HasCredits}}
    <div class="store-promo glass" style="margin-top:24px">
      <div class="store-promo-icon">ğŸª™</div>
      <div class="store-promo-body">
        <h3>Credits</h3>
        <p>Purchase credit packs to unlock premium templates.</p>
      </div>
      <a class="store-promo-link" href="/credits">Buy Credits â†’</a>
    </div>
    {{end}}

    <footer class="footer">
      <p>
        <a href="/">â† Back to GoopÂ²</a> &middot;
        <a href="https://github.com/petervdpas/goop2" target="_blank">GoopÂ² on GitHub</a>
      </p>
    </footer>

    <script>
      (function(){
        var t = document.getElementById('themeToggle'),
            i = t.querySelector('.theme-icon'),
            h = document.documentElement,
            s = localStorage.getItem('theme') || 'dark';
        h.setAttribute('data-theme', s);
        i.textContent = s === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        t.onclick = function() {
          s = h.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
          h.setAttribute('data-theme', s);
          localStorage.setItem('theme', s);
          i.textContent = s === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
        };
      })();
    </script>
  </div>
</body>
</html>
