basePath: /
definitions:
  routes.callChannelRequest:
    properties:
      channel_id:
        example: nc-abc123
        type: string
    type: object
  routes.callModeResponse:
    properties:
      first:
        type: boolean
      mode:
        example: native
        type: string
      platform:
        example: linux
        type: string
    type: object
  routes.callMuteResponse:
    properties:
      muted:
        type: boolean
    type: object
  routes.callSessionStatus:
    properties:
      audio_on:
        type: boolean
      channel_id:
        type: string
      hung:
        type: boolean
      is_origin:
        type: boolean
      pc_state:
        type: string
      remote_peer:
        type: string
      video_on:
        type: boolean
    type: object
  routes.callStartRequest:
    properties:
      channel_id:
        example: nc-abc123
        type: string
      remote_peer:
        example: 12D3KooWXxx...
        type: string
    type: object
  routes.callStartResponse:
    properties:
      channel_id:
        example: nc-abc123
        type: string
      status:
        example: started
        type: string
    type: object
  routes.callVideoResponse:
    properties:
      disabled:
        type: boolean
    type: object
  routes.clientLogRequest:
    properties:
      level:
        example: warn
        type: string
      message:
        example: getUserMedia failed
        type: string
      source:
        example: call
        type: string
    type: object
  routes.dataColumnRequest:
    properties:
      column: {}
      table:
        example: my_table
        type: string
    type: object
  routes.dataDeleteRequest:
    properties:
      filter:
        additionalProperties: {}
        type: object
      table:
        example: my_table
        type: string
    type: object
  routes.dataInsertRequest:
    properties:
      row:
        additionalProperties: {}
        type: object
      table:
        example: my_table
        type: string
    type: object
  routes.dataPolicyRequest:
    properties:
      policy:
        example: group
        type: string
      table:
        example: my_table
        type: string
    type: object
  routes.dataQueryRequest:
    properties:
      filter:
        additionalProperties: {}
        type: object
      limit:
        example: 100
        type: integer
      table:
        example: my_table
        type: string
    type: object
  routes.dataRenameRequest:
    properties:
      new_name:
        example: new_name
        type: string
      table:
        example: my_table
        type: string
    type: object
  routes.dataTableCreateRequest:
    properties:
      columns:
        items: {}
        type: array
      name:
        example: my_table
        type: string
    type: object
  routes.dataTableRequest:
    properties:
      table:
        example: my_table
        type: string
    type: object
  routes.dataUpdateRequest:
    properties:
      filter:
        additionalProperties: {}
        type: object
      set:
        additionalProperties: {}
        type: object
      table:
        example: my_table
        type: string
    type: object
  routes.docsDeleteRequest:
    properties:
      filename:
        example: notes.pdf
        type: string
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
    type: object
  routes.groupCreateRequest:
    properties:
      app_type:
        type: string
      max_members:
        type: integer
      name:
        example: My Group
        type: string
      volatile:
        type: boolean
    type: object
  routes.groupCreateResponse:
    properties:
      id:
        example: a1b2c3d4e5f6a1b2
        type: string
      status:
        example: created
        type: string
    type: object
  routes.groupHostJoinRequest:
    properties:
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
      host_peer_id:
        example: 12D3KooWXxx...
        type: string
    type: object
  routes.groupIDRequest:
    properties:
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
    type: object
  routes.groupMaxMembersRequest:
    properties:
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
      max_members:
        example: 20
        type: integer
    type: object
  routes.groupMetaRequest:
    properties:
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
      max_members:
        example: 20
        type: integer
      name:
        example: New Name
        type: string
    type: object
  routes.groupPeerRequest:
    properties:
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
      peer_id:
        example: 12D3KooWXxx...
        type: string
    type: object
  routes.groupSendRequest:
    properties:
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
      payload: {}
    type: object
  routes.listenControlRequest:
    properties:
      action:
        example: play
        type: string
      index:
        example: 2
        type: integer
      position:
        example: 42.5
        type: number
    type: object
  routes.listenCreateRequest:
    properties:
      name:
        example: My Listen Group
        type: string
    type: object
  routes.listenJoinRequest:
    properties:
      group_id:
        example: a1b2c3d4e5f6a1b2
        type: string
      host_peer_id:
        example: 12D3KooWXxx...
        type: string
    type: object
  routes.listenLoadRequest:
    properties:
      file_path:
        type: string
      file_paths:
        items:
          type: string
        type: array
    type: object
  routes.listenQueueAddRequest:
    properties:
      file_paths:
        items:
          type: string
        type: array
    type: object
  routes.loopbackICERequest:
    properties:
      candidate:
        type: string
      sdpMLineIndex:
        type: integer
      sdpMid:
        type: string
    type: object
  routes.loopbackOfferRequest:
    properties:
      sdp:
        type: string
    type: object
  routes.loopbackOfferResponse:
    properties:
      sdp:
        type: string
    type: object
  routes.mqAckRequest:
    properties:
      from_peer_id:
        example: 12D3KooWXxx...
        type: string
      msg_id:
        example: a1b2c3d4-...
        type: string
    type: object
  routes.mqSendRequest:
    properties:
      msg_id:
        example: uuid-optional
        type: string
      payload: {}
      peer_id:
        example: 12D3KooWXxx...
        type: string
      topic:
        example: call:nc-abc123
        type: string
    type: object
  routes.mqSendResponse:
    properties:
      msg_id:
        example: a1b2c3d4-...
        type: string
      status:
        example: delivered
        type: string
    type: object
  routes.quickSettingsRequest:
    properties:
      email:
        type: string
      hide_unverified:
        type: boolean
      label:
        type: string
      open_sites_external:
        type: boolean
      preferred_cam:
        type: string
      preferred_mic:
        type: string
      theme:
        type: string
      use_services:
        type: boolean
      verification_token:
        type: string
      video_disabled:
        type: boolean
    type: object
  routes.quickSettingsResponse:
    properties:
      email:
        type: string
      hide_unverified:
        type: boolean
      label:
        type: string
      open_sites_external:
        type: boolean
      preferred_cam:
        type: string
      preferred_mic:
        type: string
      theme:
        type: string
      verification_token:
        type: string
      video_disabled:
        type: boolean
    type: object
  routes.statusOK:
    properties:
      status:
        example: ok
        type: string
    type: object
info:
  contact: {}
  description: All HTTP + MQ endpoints exposed by the goop2 viewer.\n\nAll peer-to-peer
    signaling travels through MQ (POST /api/mq/send → P2P → /api/mq/events SSE).\nSee
    x-mq-topics in the raw spec (/api/openapi.json) for the full topic contract.
  title: goop2 Viewer API
  version: 1.0.0
paths:
  /api/avatar:
    get:
      produces:
      - image/jpeg
      - image/png
      responses:
        "200":
          description: Image data
          schema:
            type: string
      summary: Get own avatar image
      tags:
      - avatar
  /api/avatar/delete:
    delete:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Delete own avatar
      tags:
      - avatar
  /api/avatar/peer/{id}:
    get:
      parameters:
      - description: Peer ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - image/jpeg
      - image/png
      responses:
        "200":
          description: Image data
          schema:
            type: string
      summary: Get a peer's avatar image
      tags:
      - avatar
  /api/avatar/upload:
    post:
      consumes:
      - multipart/form-data
      parameters:
      - description: Avatar image
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Upload own avatar (multipart image)
      tags:
      - avatar
  /api/call/accept:
    post:
      consumes:
      - application/json
      description: 'Creates the Go-side Pion PeerConnection for an incoming call.\nGo
        sends call-ack via MQ; origin then connects MSE.\nFlow: receive call-request
        via MQ → POST /api/call/accept → Go sends call-ack → origin''s _handleCallAck
        → _connectNative()'
      parameters:
      - description: Accept request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.callStartRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.callStartResponse'
      summary: Accept an incoming Pion session (native mode, target)
      tags:
      - call
  /api/call/active:
    get:
      description: Returns non-hung sessions so the browser can restore the call overlay
        after page navigation.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/routes.callSessionStatus'
            type: array
      summary: List active Pion sessions (native mode)
      tags:
      - call
  /api/call/debug:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Debug dump of all active sessions
      tags:
      - call
  /api/call/hangup:
    post:
      consumes:
      - application/json
      parameters:
      - description: Hangup request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.callChannelRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Hang up a Pion session
      tags:
      - call
  /api/call/loopback/{channel}/ice:
    post:
      consumes:
      - application/json
      parameters:
      - description: Channel ID
        in: path
        name: channel
        required: true
        type: string
      - description: ICE candidate
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.loopbackICERequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Send browser ICE candidates to Go LocalPC (Phase 4 loopback)
      tags:
      - call
  /api/call/loopback/{channel}/offer:
    post:
      consumes:
      - application/json
      parameters:
      - description: Channel ID
        in: path
        name: channel
        required: true
        type: string
      - description: SDP offer
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.loopbackOfferRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.loopbackOfferResponse'
      summary: Send browser SDP offer to Go LocalPC (Phase 4 loopback)
      tags:
      - call
  /api/call/media/{channel}:
    get:
      description: Binary WebM frames sent over WebSocket. First message is the init
        segment; subsequent messages are clusters.\nBrowser feeds these to MSE (MediaSource
        Extensions) for display.
      parameters:
      - description: Channel ID
        in: path
        name: channel
        required: true
        type: string
      responses:
        "101":
          description: WebSocket upgrade
          schema:
            type: string
      summary: WebSocket — live WebM stream of remote video/audio (native mode)
      tags:
      - call
  /api/call/mode:
    get:
      description: Returns native (Go/Pion active) or browser (standard WebRTC).\nSafe
        to call regardless of whether the call feature is enabled.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.callModeResponse'
      summary: Query call stack mode (native vs browser)
      tags:
      - call
  /api/call/self/{channel}:
    get:
      description: Binary WebM frames (VP8 video only, no audio track in init segment).\nBrowser
        feeds to MSE for the local camera inset (PiP).
      parameters:
      - description: Channel ID
        in: path
        name: channel
        required: true
        type: string
      responses:
        "101":
          description: WebSocket upgrade
          schema:
            type: string
      summary: WebSocket — self-view WebM stream (local camera, Linux native only)
      tags:
      - call
  /api/call/start:
    post:
      consumes:
      - application/json
      description: 'Creates the Go-side Pion PeerConnection.\nThe browser must call
        this before sending call-request via MQ.\nFlow: POST /api/call/start → _sendMQ(call-request)
        → wait for call-ack → _connectNative()'
      parameters:
      - description: Start request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.callStartRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.callStartResponse'
      summary: Register a new outbound Pion session (native mode, origin)
      tags:
      - call
  /api/call/toggle-audio:
    post:
      consumes:
      - application/json
      parameters:
      - description: Channel
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.callChannelRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.callMuteResponse'
      summary: Toggle local audio track mute (native mode)
      tags:
      - call
  /api/call/toggle-video:
    post:
      consumes:
      - application/json
      parameters:
      - description: Channel
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.callChannelRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.callVideoResponse'
      summary: Toggle local video track (native mode)
      tags:
      - call
  /api/data/delete:
    post:
      consumes:
      - application/json
      parameters:
      - description: Delete request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataDeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Delete rows from a table
      tags:
      - data
  /api/data/insert:
    post:
      consumes:
      - application/json
      parameters:
      - description: Insert request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataInsertRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Insert a row into a table
      tags:
      - data
  /api/data/query:
    post:
      consumes:
      - application/json
      parameters:
      - description: Query request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataQueryRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
      summary: Query rows from a table
      tags:
      - data
  /api/data/tables:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
      summary: List SQLite tables with schema and policies
      tags:
      - data
  /api/data/tables/add-column:
    post:
      consumes:
      - application/json
      parameters:
      - description: Add column request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataColumnRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Add a column to a table
      tags:
      - data
  /api/data/tables/create:
    post:
      consumes:
      - application/json
      parameters:
      - description: Create request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataTableCreateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Create a new SQLite table
      tags:
      - data
  /api/data/tables/delete:
    post:
      consumes:
      - application/json
      parameters:
      - description: Table name
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataTableRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Drop a table
      tags:
      - data
  /api/data/tables/describe:
    post:
      consumes:
      - application/json
      parameters:
      - description: Table name
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataTableRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Describe a table's schema and policy
      tags:
      - data
  /api/data/tables/drop-column:
    post:
      consumes:
      - application/json
      parameters:
      - description: Drop column request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataColumnRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Drop a column from a table
      tags:
      - data
  /api/data/tables/rename:
    post:
      consumes:
      - application/json
      parameters:
      - description: Rename request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataRenameRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Rename a table
      tags:
      - data
  /api/data/tables/set-policy:
    post:
      consumes:
      - application/json
      parameters:
      - description: Policy request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataPolicyRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Set sharing policy for a table (private, group, public)
      tags:
      - data
  /api/data/update:
    post:
      consumes:
      - application/json
      parameters:
      - description: Update request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.dataUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Update rows in a table
      tags:
      - data
  /api/docs/browse:
    get:
      parameters:
      - description: Group ID
        in: query
        name: group_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Aggregate file lists from all group members (parallel fetch)
      tags:
      - docs
  /api/docs/delete:
    post:
      consumes:
      - application/json
      parameters:
      - description: Delete request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.docsDeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Delete a shared file (local access only)
      tags:
      - docs
  /api/docs/download:
    get:
      parameters:
      - description: Group ID
        in: query
        name: group_id
        required: true
        type: string
      - description: Filename
        in: query
        name: file
        required: true
        type: string
      - description: Peer ID (empty = self)
        in: query
        name: peer_id
        type: string
      - description: 'Pass ''1'' for Content-Disposition: inline'
        in: query
        name: inline
        type: string
      responses:
        "200":
          description: File content
          schema:
            type: string
      summary: Download a file (local store or proxied from remote peer)
      tags:
      - docs
  /api/docs/my:
    get:
      parameters:
      - description: Group ID
        in: query
        name: group_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: List my shared files for a group
      tags:
      - docs
  /api/docs/upload:
    post:
      consumes:
      - multipart/form-data
      parameters:
      - description: Group ID
        in: formData
        name: group_id
        required: true
        type: string
      - description: File to upload (max 50 MB)
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Upload a file to share with the group (multipart)
      tags:
      - docs
  /api/groups:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
      summary: List hosted groups with live member data
      tags:
      - groups
    post:
      consumes:
      - application/json
      parameters:
      - description: Create request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupCreateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.groupCreateResponse'
      summary: Create a new hosted group
      tags:
      - groups
  /api/groups/close:
    post:
      consumes:
      - application/json
      parameters:
      - description: Group ID
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupIDRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Close and delete a hosted group (broadcasts group:close via MQ to all
        members)
      tags:
      - groups
  /api/groups/invite:
    post:
      consumes:
      - application/json
      parameters:
      - description: Invite request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupPeerRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Invite a peer to a hosted group (sends group.invite via MQ)
      tags:
      - groups
  /api/groups/join:
    post:
      consumes:
      - application/json
      parameters:
      - description: Join request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupHostJoinRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Join a remote group as a member (sends group:join via MQ)
      tags:
      - groups
  /api/groups/join-own:
    post:
      consumes:
      - application/json
      parameters:
      - description: Group ID
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupIDRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Host joins own group as a member
      tags:
      - groups
  /api/groups/kick:
    post:
      consumes:
      - application/json
      parameters:
      - description: Kick request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupPeerRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Kick a member from a hosted group
      tags:
      - groups
  /api/groups/leave:
    post:
      consumes:
      - application/json
      parameters:
      - description: Group ID
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupIDRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Leave a group as a member (sends group:leave via MQ)
      tags:
      - groups
  /api/groups/leave-own:
    post:
      consumes:
      - application/json
      parameters:
      - description: Group ID
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupIDRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Host leaves own group
      tags:
      - groups
  /api/groups/max-members:
    post:
      consumes:
      - application/json
      parameters:
      - description: Max members request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupMaxMembersRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Update max member limit for a hosted group
      tags:
      - groups
  /api/groups/meta:
    post:
      consumes:
      - application/json
      parameters:
      - description: Meta request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupMetaRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Update group name and/or max_members (broadcasts group:meta via MQ)
      tags:
      - groups
  /api/groups/rejoin:
    post:
      consumes:
      - application/json
      parameters:
      - description: Rejoin request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupHostJoinRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Rejoin a previously joined group
      tags:
      - groups
  /api/groups/send:
    post:
      consumes:
      - application/json
      parameters:
      - description: Send request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupSendRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Send a payload to a group (host broadcasts, member sends to host)
      tags:
      - groups
  /api/groups/subscriptions:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: List group subscriptions (member side) with host reachability
      tags:
      - groups
  /api/groups/subscriptions/remove:
    post:
      consumes:
      - application/json
      parameters:
      - description: Remove request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.groupHostJoinRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Remove a stale subscription record
      tags:
      - groups
  /api/listen/close:
    post:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Host closes the listen group
      tags:
      - listen
  /api/listen/control:
    post:
      consumes:
      - application/json
      parameters:
      - description: Control request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.listenControlRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Playback control — play, pause, seek, next, prev, skip, remove
      tags:
      - listen
  /api/listen/create:
    post:
      consumes:
      - application/json
      parameters:
      - description: Create request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.listenCreateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Host creates a listen group
      tags:
      - listen
  /api/listen/join:
    post:
      consumes:
      - application/json
      parameters:
      - description: Join request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.listenJoinRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Listener joins a group
      tags:
      - listen
  /api/listen/leave:
    post:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Listener leaves the current group
      tags:
      - listen
  /api/listen/load:
    post:
      consumes:
      - application/json
      parameters:
      - description: Load request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.listenLoadRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Load MP3 file(s) as playlist (local access only)
      tags:
      - listen
  /api/listen/queue/add:
    post:
      consumes:
      - application/json
      parameters:
      - description: Queue add request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.listenQueueAddRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Append files to the playlist (local access only)
      tags:
      - listen
  /api/listen/state:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Current listen group state
      tags:
      - listen
  /api/listen/stream:
    get:
      description: Chunked streaming response (audio/mpeg). Connect an HTML audio
        element src directly to this URL.
      produces:
      - audio/mpeg
      responses:
        "200":
          description: Chunked audio stream
          schema:
            type: string
      summary: Live MP3 audio stream
      tags:
      - listen
  /api/logs:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties:
                type: string
              type: object
            type: array
      summary: Snapshot of recent Go process log lines
      tags:
      - logs
  /api/logs/client:
    post:
      consumes:
      - application/json
      parameters:
      - description: Log entry
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.clientLogRequest'
      responses:
        "204":
          description: Accepted
      summary: Sink for browser-side log messages
      tags:
      - logs
  /api/logs/stream:
    get:
      produces:
      - text/event-stream
      responses:
        "200":
          description: SSE stream
          schema:
            type: string
      summary: SSE stream of new Go process log lines
      tags:
      - logs
  /api/mq/ack:
    post:
      consumes:
      - application/json
      description: Called by the browser after processing an incoming MQ message.\nRelays
        an application-level ACK to the sender.\nIf from_peer_id is empty (PublishLocal
        event) the ACK is silently dropped.
      parameters:
      - description: Ack request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.mqAckRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Acknowledge a received MQ message
      tags:
      - mq
  /api/mq/events:
    get:
      description: 'THE single browser event stream. Every incoming P2P MQ message
        and every PublishLocal event arrives here.\nEvent frames are SSE ''message''
        events with JSON body: {type, msg:{id,seq,topic,payload}, from}.\nKeep-alive:
        the stream never closes unless the server shuts down or the browser disconnects.'
      produces:
      - text/event-stream
      responses:
        "200":
          description: SSE stream
          schema:
            type: string
      summary: SSE stream — incoming MQ messages and delivery receipts
      tags:
      - mq
  /api/mq/send:
    post:
      consumes:
      - application/json
      description: 'Delivers the payload to the remote peer over the MQ P2P protocol.\nBlocks
        until the peer sends a transport ACK (up to 30 s).\nTopic convention: call:{channelId},
        group:{groupId}:{type}, group.invite, chat, chat.broadcast'
      parameters:
      - description: Send request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.mqSendRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.mqSendResponse'
        "400":
          description: missing peer_id or topic
          schema:
            type: string
        "504":
          description: peer unreachable within 30 s
          schema:
            type: string
      summary: Send an MQ message to a peer
      tags:
      - mq
  /api/openapi.json:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: This OpenAPI 3.0 spec (generated by swaggo/swag)
      tags:
      - logs
  /api/peer/content:
    get:
      parameters:
      - description: Peer ID
        in: query
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Fetch a remote peer's site content (HTML string)
      tags:
      - peers
  /api/peers:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
      summary: List all known peers with metadata
      tags:
      - peers
  /api/peers/favorite:
    post:
      consumes:
      - application/json
      parameters:
      - description: '{ peer_id, favorite }'
        in: body
        name: body
        required: true
        schema:
          additionalProperties: true
          type: object
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Toggle favorite flag for a peer
      tags:
      - peers
  /api/peers/probe:
    post:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Probe all known peers for reachability
      tags:
      - peers
  /api/self:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: This peer's own identity and metadata
      tags:
      - peers
  /api/services/check:
    get:
      parameters:
      - description: Service base URL
        in: query
        name: url
        required: true
        type: string
      - description: 'Service type: registration, credits, email, templates'
        in: query
        name: type
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Check a single service URL (pre-save validation)
      tags:
      - settings
  /api/services/health:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Ping all configured external services
      tags:
      - settings
  /api/settings/quick:
    post:
      consumes:
      - application/json
      parameters:
      - description: Partial settings
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/routes.quickSettingsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.statusOK'
      summary: Partial settings update — only provided (non-null) fields are written
      tags:
      - settings
  /api/settings/quick/get:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.quickSettingsResponse'
      summary: Read current quick settings (label, email, theme, device prefs, flags)
      tags:
      - settings
schemes:
- http
swagger: "2.0"
